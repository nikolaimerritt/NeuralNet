<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Neural Net </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Neural Net ">
    <meta name="generator" content="docfx 2.58.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/night-owl.min.css">
    <link rel="stylesheet" href="../styles/colors.css">
    <link rel="stylesheet" href="../styles/discord.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>

  <body>
        <div class="top-navbar">

            <a href="javascript:void(0);" class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="24" height="24" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>

            
            <a class="brand" href="../index.html">
              <img src="../logo.svg" alt="" class="logomark">
              <span class="brand-title"></span>
            </a>
        </div>

        <div class="body-content">

            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">

                <div class="sidebar">
                    
                    
                    
                    
                    <div>
                      
                      <a class="brand" href="../index.html">
                        <img src="../logo.svg" alt="" class="logomark">
                        <span class="brand-title"></span>
                      </a>
                      <div id="navbar">
                    
                      </div>
                    
                    </div>


                    <div class="sidebar-item-separator"></div>

                        
                        <div id="sidetoggle">
                          <div id="sidetoc"></div>
                        </div>

                </div>

                <div class="footer">
                  
                  <span>Generated by <strong>DocFX</strong></span>
                </div>
            </nav>

            <main class="main-panel">

                <div role="main" class="hide-when-search">

                        
                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                    <article class="content wrap" id="_content" data-uid="nnet">
<h1 id="neural-net">Neural Net</h1>

<p>A <code>NeuralNet</code> takes a <a href="https://numerics.mathdotnet.com/Matrix.html"><code>Vector&lt;double&gt;</code></a> as input and predicts the appropriate <a href="https://numerics.mathdotnet.com/Matrix.html"><code>Vector&lt;double&gt;</code></a><code>to output. By giving</code>NeuralNet<code>a training data set, consisting of pairs of sample inputs with the correct output, the</code>NeuralNet<code>will learn to produce more accurate outputs. Not only should the</code>NeuralNet` perform accuately with the training data given, but it should also perform just as accuately with similar inputs that it has not been trained on.</p>
<h2 id="creating-a-blank-neuralnet">Creating a Blank NeuralNet</h2>
<p>See <a href="neural-net-factory.html">NeuralNetFactory</a> for how to create a &quot;blank&quot; <code>NeuralNet</code> that is ready to train.</p>
<h2 id="preparing-training-data-for-a-neuralnet">Preparing Training Data for a NeuralNet</h2>
<p>The NeuralNet will learn how to produce approximately the right output for a given input. Thus, you will need to prepare your data as a list of inputs paired with the corresponding output you want to be produced.</p>
<p>Because a <code>NeuralNet</code> is a mathematical object, each input and output will need to be a <a href="https://numerics.mathdotnet.com/Matrix.html"><code>Vector&lt;double&gt;</code></a>. Every input vector must have the same length, and every output vector must have the same length. The output vectors can have different lengths to the input vectors, however.
If you want your <code>NeuralNet</code> to input or output a single number, you must use <a href="https://numerics.mathdotnet.com/Matrix.html"><code>Vector&lt;double&gt;</code></a>s of length 1.</p>
<p>See <a class="xref" href="creating-neural-network.html">creating your first neural network</a> for a detailed example.</p>
<h2 id="fitting-a-neuralnet-to-training-data">Fitting a NeuralNet to Training Data</h2>
<p>Once you have prepared your training data into a collection of paired input and output vectors, use <code>NeuralNet.Fit(...)</code> to train the <code>NeuralNet</code>. This will repeatedly adjust the neural network so that its predicted output vectors are increasingly closer to the expected output vectors.</p>
<pre><code class="lang-cs">List&lt;(Vector&lt;double&gt;, Vector&lt;double&gt;)&gt; trainingData = ... ; // see above
neuralNet.Fit(trainingData, numEpochs: 50000);
</code></pre>
<p>There are three arguments to configure the training:</p>
<h3 id="number-of-epochs">Number of Epochs</h3>
<p>The <code>NeuralNet</code> trains from the entire data set once every epoch. In other words, the amount of epochs is the amount of times the <code>NeuralNet</code> learns from each data point in <code>traningData</code>.</p>
<p>Up to a point, the more times the <code>NeuralNet</code> learns from each data point, the more accurate the <code>NeuralNet</code> will be. However, if the number of epochs is higher than necessary, the <code>NeuralNet</code> will try &quot;too hard&quot; to match the input data exactly, and start to lose its ability to perform well on similar data that it has not seen. This is called <a href="https://www.ibm.com/cloud/learn/overfitting">over-fitting</a>.</p>
<p>It is important to pick a value of <code>numEpochs</code> that is high enough for the <code>NeuralNet</code> to learn well from each data point, but not too high that the <code>NeuralNet</code> starts to over-fit. Read <a class="xref" href="neural-net.html#measuring-performance">Measuring Performance while Training</a> for more information.</p>
<h3 id="batch-size">Batch Size</h3>
<p><code>NeuralNet.Fit(...)</code> performs <em>batch gradient descent</em>: instead of learning from each data point one at a time, the <code>NeuralNet</code> learns from multiple data points at once, the amount of which is the batch size. Reccommended values range from 4 to 256, with 256 being the default value.</p>
<h3 id="batch-updating-in-parallel">Batch Updating in Parallel</h3>
<p>If this options is enabled, the <code>NeuralNet</code> learns from each data point in a given batch in parallel. (<em>Technical note</em>: the <code>NeuralNet</code> calculates the cost gradient for each data point in the batch in parallel, then learns from the average of the cost gradients sequentially.) This is done for performance gains, which will be greater the higher the <a href="neural-net.html#batch-size">Batch Size</a>.</p>
<h2 id="measuring-performance">Measuring Performance</h2>
<h3 id="average-cost">Average Cost</h3>
<p>You can measure a <code>NeuralNet</code>'s performance using <code>NeuralNet.AverageCost(...)</code>.</p>
<p>When fitting to training data, the neural network seeks to decrease the <a class="xref" href="cost-function.html">cost</a> quantifying the error in the neural network's predicted outputs versus the expected outputs in the training data. <code>NeuralNet.AverageCost(...)</code> returns the average cost of the neural network's error in the supplied testing data.</p>
<pre><code class="lang-cs">NeuralNet neuralNet = ... ;
List&lt;(Vector&lt;double&gt; input, Vector&lt;double&gt; expectedOutput)&gt; testingData = ... ;
double averageCost = neuralNet.AverageCost(testingData);
</code></pre>
<div class="WARNING">
<h5>Warning</h5>
<p>To get a meaningful indication of how the neural network performs, supply <code>AverageCost(...)</code> with testing data that is <strong>different</strong> from the training data
This way, the average cost will measure how well the neural network generalises to data it has not trained on</p>
</div>
<h3 id="measuring-cost-while-training">Measuring Cost while Training</h3>
<p>You can assess a <code>NeuralNet</code>'s performance while training by supplying testing data to <code>NeuralNet.Fit(...)</code>. This will assess the <code>NeuralNet</code>'s performance by writing the average cost of the <code>NeuralNet</code> on the testing data periodically while training.</p>
<pre><code class="lang-cs">NeuralNet neuralNet = ... ;
List&lt;(Vector&lt;double&gt;, Vector&lt;double&gt;)&gt; trainingData = ... ;
List&lt;(Vector&lt;double&gt;, Vector&lt;double&gt;)&gt; testingData = ... ;
neuralNet.Fit(trainingData, testingData);
</code></pre>
<p>The amount of times the average cost is written to the console can be configured by adjusting <code>numAssessments</code>. This number is 15 by default.</p>
<pre><code class="lang-cs">NeuralNet neuralNet = ... ;
List&lt;(Vector&lt;double&gt;, Vector&lt;double&gt;)&gt; trainingData = ... ;
List&lt;(Vector&lt;double&gt;, Vector&lt;double&gt;)&gt; testingData = ... ;
neuralNet.Fit(trainingData, testingData, numAssessments: 20);
</code></pre>
<h2 id="predicting-output-vectors">Predicting Output Vectors</h2>
<p>Given an input <a href="https://numerics.mathdotnet.com/Matrix.html"><code>Vector&lt;double&gt;</code></a>, the <code>NeuralNet</code> predicts the appropriate output <a href="https://numerics.mathdotnet.com/Matrix.html"><code>Vector&lt;double&gt;</code></a>. Once the NeuralNet has sufficiently <a href="neural-net.html#fitting-a-neuralnet-to-training-data">fitted to training data</a>, you can expect the predicted output to be accurate, but not a complete match.</p>
<p>The following example uses a <code>NeuralNet</code> with an input layer of size 10 and an output layer of size 5. The example shows the <code>NeuralNet</code>'s predicted output on three random input vectors.</p>
<pre><code class="lang-cs">
List&lt;NeuralLayerConfig&gt; layerStructure = new()
{
    new InputLayer(size: 10),
    ...
    new OutputLayer(size: 5)
};

NeuralNet neuralNet = NeuralNetFactory.OptimisedForRelu(layerStructure, ...);
neuralNet.Fit(...);

for (int i = 0; i &lt; 3; i++)
{
    Vector&lt;double&gt; input = Vector&lt;double&gt;.Build.Random(length: 10);
    Vector&lt;double&gt; predictedOutput = neuralNet.Predict(input); // is of length 5

    Console.WriteLine($&quot;input: {input}&quot;);
    Console.WriteLine($&quot;predicted output: {predictedOutput}&quot;);
    Console.WriteLine();
}
</code></pre>
</article>
              
                </div>
            </main>
        </div>

        
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<script type="text/javascript" src="../styles/jquery.twbsPagination.js"></script>
<script type="text/javascript" src="../styles/url.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script type="text/javascript" src="../styles/docfx.js"></script>
<script type="text/javascript" src="../styles/main.js"></script>

    </body>

</html>
