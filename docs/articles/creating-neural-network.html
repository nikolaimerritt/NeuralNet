<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Creating your first Neural Network | NeuralNet </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Creating your first Neural Network | NeuralNet ">
    <meta name="generator" content="docfx 2.58.4.0">
    
    <link rel="shortcut icon" href="../images/icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/night-owl.min.css">
    <link rel="stylesheet" href="../styles/colors.css">
    <link rel="stylesheet" href="../styles/discord.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>

  <body>
        <div class="top-navbar">

            <a href="javascript:void(0);" class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="24" height="24" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>

            
            <a class="brand" href="../index.html">
              <img src="../images/icon.png" alt="" class="logomark">
              <span class="brand-title"></span>
            </a>
        </div>

        <div class="body-content">

            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">

                <div class="sidebar">
                    
                    
                    
                    
                    <div>
                      
                      <a class="brand" href="../index.html">
                        <img src="../images/icon.png" alt="" class="logomark">
                        <span class="brand-title"></span>
                      </a>
                      <div id="navbar">
                    
                      </div>
                    
                    </div>


                    <div class="sidebar-item-separator"></div>

                        
                        <div id="sidetoggle">
                          <div id="sidetoc"></div>
                        </div>

                </div>

                <div class="footer">
                  
                  <span>Generated by <strong>DocFX</strong></span>
                </div>
            </nav>

            <main class="main-panel">

                <div role="main" class="hide-when-search">

                        
                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                    <article class="content wrap" id="_content" data-uid="creating-nnet">

<head>
    <link rel="stylesheet" href="../styles/style.css">
</head>
<h1 id="creating-your-first-neural-network">Creating your first Neural Network</h1>
<p>This article will show you how to initialise and train your first neural network.</p>
<p>Here we'll create our first neural network. The neural network we're creating will do as simple a task as possible, while still being (technically) impressive: we'll teach it how to square numbers! Although our goal here is kind of boring, it won't get in the way of the process shown here, which will apply to any other neural network you make.</p>
<p>This example was adapted from <a href="xref:https://stackoverflow.com/questions/55170460/neural-network-for-square-x2-approximation">a question on stackoverflow</a> that I stumbled across. I recommend reading through the question and top answer. They address the same problem using the same method as this article, with helpful explanatory comments.</p>
<p>First, we need to <a class="xref" href="creating-neural-network.html#preparing-our-training-data">prepare our training data</a>. Then, we <a class="xref" href="creating-neural-network.html#initialising-a-neural-network">initialise</a> and then <a class="xref" href="creating-neural-network.html#training-a-neural-network">train</a> our neural network. Finally, we'll round off by <a class="xref" href="creating-neural-network.html#seeing-how-well-our-neural-network-performs">seeing how well our neural network performs</a>.</p>
<h2 id="preparing-our-data">Preparing our data</h2>
<p>A <a class="xref" href="neural-net.html"><code>NeuralNet</code></a> is, fundamentally, a mathematical object. It takes in vectors as inputs and predicts the appropriate vectors to output. By giving a <a class="xref" href="neural-net.html"><code>NeuralNet</code></a> many sample input vectors paired with the expected vectors the <a class="xref" href="neural-net.html"><code>NeuralNet</code></a> should ideally output, the <code>NeuralNet</code> &quot;learns&quot; to produce increasingly accurate output vectors. This process is known as <a class="xref" href="neural-net.html#fitting-a-neuralnet-to-training-data">fitting</a>.</p>
<p>Since all we want our <a class="xref" href="neural-net.html"><code>NeuralNet</code></a> to do is square numbers, the data we are working with is very simple. Our inputs are random numbers between -50 and 50, stored in a <a href="https://numerics.mathdotnet.com/Matrix.html"><code>Vector&lt;double&gt;</code></a> of length 1. Our outputs are the corresponding inputs squared.</p>
<p>We'll start by writing a function that'll give us such input-output pairs.</p>
<pre><code class="lang-cs">List&lt;(Vector&lt;double&gt;, Vector&lt;double&gt;)&gt; InputOutputPairs(int numPairs)
{
    List&lt;(Vector&lt;double&gt; input, Vector&lt;double&gt; expectedOutput)&gt; pairs = new(capacity: numPairs);
    
    for (int i = 0; i &lt; numPairs; i++)
    {
        Vector&lt;double&gt; input = 50 * Vector&lt;double&gt;.Build.Random(length: 1);
        Vector&lt;double&gt; expectedOutput = input.PointwisePower(2);
        pairs.Add((input, expectedOutput));
    }
    return pairs;
}
</code></pre>
<h2 id="initialising-our-neural-network">Initialising our Neural Network</h2>
<p>Before we start training, we need to create a &quot;blank&quot; <a class="xref" href="neural-net.html"><code>NeuralNet</code></a> that is ready to learn. We use <a class="xref" href="neural-net-factory.html"><code>NeuralNetFactory</code></a> to create a <a class="xref" href="neural-net.html"><code>NeuralNet</code></a> that is optimised for our project.</p>
<h3 id="layer-structure">Layer Structure</h3>
<p>First, we have to decide on our neural network's layer structure. In this project, we take a single number as input and output a single number, so our input layer and output layer will both have a size of 1. To give our neural network some complexity, we'll also have two hidden layers, both of size 8. These hidden layers will use <a class="xref" href="activation.html#relu-activation"><code>ReLU activation</code></a>: an <a class="xref" href="activation.html">activation</a> which works well for a wide range of projects.</p>
<p>Overall, our layer structure is:
- an input layer of size 1
- a hidden layer of size 8 using ReLU activation
- a hidden layer of size 8 using ReLU activation
- an output layer of size 1</p>
<p>We'll package the structure of each layer into an <a class="xref" href="neural-layer-config.html#input-layer"><code>InputLayer</code></a>, <a class="xref" href="neural-layer-config.html#hidden-layer"><code>HiddenLayer</code></a> or <a class="xref" href="neural-layer-config.html#output-layer"><code>OutputLayer</code></a> record, all three of which inherit from <a class="xref" href="neural-layer-config.html"><code>NeuralLayerConfig</code></a>. The structure of our neural network is represented by a <code>List&lt;NeuralLayerConfig&gt;</code>:</p>
<pre><code class="lang-cs">List&lt;NeuralLayerConfig&gt; layerStructure = new()
{
    new InputLayer(size: 1),
    new HiddenLayer(size: 8, activation: new ReluActivation()),
    new HiddenLayer(size: 8, activation: new ReluActivation()),
    new OutputLayer(size: 1)
};
</code></pre>
<h3 id="initialising-using-neuralnetfactory">Initialising using <code>NeuralNetFactory</code></h3>
<p>The <a class="xref" href="neural-net-factory.html"><code>NeuralNetFactory</code></a> library class will create a <a class="xref" href="neural-net.html"><code>NeuralNet</code></a> that is optimised to learn for our project. Since we are using ReLU activation, we will make a <a class="xref" href="neural-net.html"><code>NeuralNet</code></a>, using our layer structure, that is optimised to learn with ReLU:</p>
<pre><code class="lang-cs">NeuralNet neuralNet = NeuralNetFactory.OptimisedForRelu(layerStructure);
</code></pre>
<h2 id="training-our-neural-network">Training our Neural Network</h2>
<p>To train our neural network, we supply <code>neuralNet</code> with 8000 training data to fit to.</p>
<p>We will also supply a separate collection of 2000 testing data. The neural network will not train to fit to this data: instead, the data will be used to periodically assess <code>neuralNet</code>'s performace as it learns.</p>
<pre><code class="lang-cs">List&lt;(Vector&lt;double&gt;, Vector&lt;double&gt;)&gt; trainingData = InputOutputPairs(8000);
List&lt;(Vector&lt;double&gt;, Vector&lt;double&gt;)&gt; testingData = InputOutputPairs(2000);
</code></pre>
<p>The neural network will learn from each pair in <code>trainingData</code> once every epoch. For this project, we will set the number of epochs to 15,000.</p>
<pre><code class="lang-cs">neuralNet.Fit(trainingData, testingData, numEpochs: 15000);
</code></pre>
<p>Fitting the neural network to <code>trainingData</code> took around 11 minutes on my mid-range laptop.</p>
<h2 id="seeing-how-well-our-neural-network-performs">Seeing how well our Neural Network performs</h2>
<p>To see how good <code>neuralNet</code> is at squaring numbers, let's see <code>neuralNet</code>'s performance on ten random inputs, comparing <code>neuralNet</code>'s predicted values with the true values:</p>
<pre><code class="lang-cs">foreach ((Vector&lt;double&gt; input, Vector&lt;double&gt; expectedOutput) in InputOutputPairs(10))
{
    Vector&lt;double&gt; predictedOutput = neuralNet.Predict(input);
    Console.WriteLine($&quot;{input[0]} --&gt; \t {predictedOutput[0]} \t (expected: {expectedOutput[0]})&quot;);
}
</code></pre>
<p>(Feel free to add your own formatting.)</p>
<p>My <code>neuralNet</code> performed as follows. Yours should perform similarly.</p>
<figure>
    <figcaption> Performance of `neuralNet` with 10 randomly chosen inputs, compared with the expected outputs. </figcaption>
    <img src="../images/learning-x2-perf.jpg" ,="" class="centre">
</figure>
<p>It's safe to say that <code>neuralNet</code> has roughly understood how squaring works: not only is <code>neuralNet</code> fairly accurate numerically, but it also seems to do as well with negative inputs as positive inputs. However, it struggles with squaring small numbers: e.g. 9.42 and 9.56 both get &quot;squared&quot; to 39.37 .</p>
<p>Ironing out problems like these will require more customisation and experimentation. To start, explore the different options in <a href="xref:nn-factory"><code>NeuralNetFactory</code></a> and <a class="xref" href="neural-net.html"><code>NeuralNet</code></a>. Or, make yourself more confident with what you've already learned by creating a <a class="xref" href="neural-net.html"><code>NeuralNet</code></a> that learns a different function: perhaps <code>f(x) = x^3</code> or <code>f(x) = sin(x)</code> rather than <code>f(x) = x^2</code>.</p>
</article>
              
                </div>
            </main>
        </div>

        
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<script type="text/javascript" src="../styles/jquery.twbsPagination.js"></script>
<script type="text/javascript" src="../styles/url.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script type="text/javascript" src="../styles/docfx.js"></script>
<script type="text/javascript" src="../styles/main.js"></script>

    </body>

</html>
